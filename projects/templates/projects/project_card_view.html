{%  extends 'base.html' %}
{% load static %}

{% block content %}
    <!-- <h2>Projects</h2>
    <ul>
        {% for project in projects %}
            <li>{{ project.title }}</li>
        {% endfor %}
    </ul> -->

    <section class="py-2">
        <!-- Search & Filter -->
         <div class="container px-4 px-lg-5 mt-4">
            <!-- <div class="row"> -->
                <form class="form-inline" id = "search_filter_form" style="align-content: center;" method="GET" onsubmit="window.location.reload();" onchange="let el=document.getElementById('search_filter_form');el.submit();">
                    {{ form.as_p }}
                    <!-- <form class="col form-inline", style="align-content: center;">
                        {{ form.title }}
                      </form>
                      <div class="col-1 dropdown" id="category_filter" style="width: fit-content; height: fit-content; padding: 0; margin: 0.5%;">
                          {{ form.category }}
                      </div> -->
                    <!-- <button class="col-1 btn btn-primary" type="submit">Search</button> -->
                </form>
                <!-- <form class="col form-inline", style="align-content: center;">
                    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                </form>
                <div class="col-1 dropdown" style="width: fit-content; height: fit-content; padding: 0; margin: 0.5%;">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Category
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        {% for category in categories %}
                            <a class="dropdown-item" href="#">{{ category.category }}</a>
                        {% endfor %}
                    </div>
                </div>
                <div class="col-2" style="margin:0 2%; padding: 0.25% 0; width: 75px; width: fit-content; align-content: center;">
                        <button class="btn" style="padding: 0; margin: 0;"><svg style="height: 28px; margin:0; padding: 2px; border: 2px solid black; border-radius: 20%;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M151.6 42.4C145.5 35.8 137 32 128 32s-17.5 3.8-23.6 10.4l-88 96c-11.9 13-11.1 33.3 2 45.2s33.3 11.1 45.2-2L96 146.3V448c0 17.7 14.3 32 32 32s32-14.3 32-32V146.3l32.4 35.4c11.9 13 32.2 13.9 45.2 2s13.9-32.2 2-45.2l-88-96zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h32c17.7 0 32-14.3 32-32s-14.3-32-32-32H320zm0 128c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H320zm0 128c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H320zm0 128c-17.7 0-32 14.3-32 32s14.3 32 32 32H544c17.7 0 32-14.3 32-32s-14.3-32-32-32H320z"/></svg></button>
                        !-- {{ show_grid_view }}
                        <button class="btn" id="view_btn"  style="padding: 0; margin: 0;">
                            {% if show_grid_view == true %}
                                List
                                <svg style="height: 28px; margin:0; padding: 2px; border: 2px solid black; border-radius: 20%;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"/></svg>
                            {% else %}
                                Grid
                                <svg style="height: 28px; margin:0; padding: 2px; border: 2px solid black; border-radius: 20%;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm88 64v64H64V96h88zm56 0h88v64H208V96zm240 0v64H360V96h88zM64 224h88v64H64V224zm232 0v64H208V224h88zm64 0h88v64H360V224zM152 352v64H64V352h88zm56 0h88v64H208V352zm240 0v64H360V352h88z"/></svg>
                            {% endif %}
                        </button> --!
                </div>
            </div> -->
         </div>
        <div class="container px-4 px-lg-5 mt-4">
            <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
                {% for project in projects %}
                    <div class="col mb-5">
                        <a href="#" style="text-decoration:none;">
                            <div class="card h-100">
                                <div class="badge bg-dark text-white position-absolute" style="top: 0.5rem; right: 0.5rem"> {{ project.category }} </div>
                                {% if 'media/uploads/projects' in project.project_thumbnail.url %}
                                    <img class="card-img-top" src="{{ project.project_thumbnail.url }}" alt="{{ project.title }}" style="height: 170px;" />
                                {% else %}
                                    <img class="card-img-top" src="https://dummyimage.com/450x300/dee2e6/6c757d.jpg" alt="..." />
                                {% endif %}
                                <div class="card-body p-4">
                                    <div class="text-center">
                                        <h5 class="fw-bolder"> {{project.title}} </h5>
                                        <h8 style="text-align: justify; text-justify: inter-word;"> {{ project.short_description }} </h8>
                                    </div>  
                                </div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> 
    <!-- <script>
         $(document).ready(()=> { 
             $(".dropdown-menu a").click(function(){
                $(".dropdown-toggle:first-child").html($(this).text()+' <span class="caret"></span>');
             });
         });
    </script> -->
    <script>
        // $(document).ready(()=> {
        window.onload = function() {
            console.log("Executing ....")
            // category_filter = document.getElementById("category_filter").getElementsByTagName("select")[0]
            // category_filter.classList += "btn btn-secondary"
            // options = category_filter.getElementsByTagName("option")
            // options[0].text = "Category"
            // for (let index = 0; index < options.length; index++) {
            //     options[index].classList += "dropdown-item"
            //     options[index].style.textAlign = "left"
            // }

            search_filter_form = document.getElementById("search_filter_form")
            grid_div = document.createElement("div")
            grid_div.classList += "row"

            filters = search_filter_form.getElementsByTagName("p")
            let search = filters[0], category_filter = filters[1];
            // let button = search_filter_form.getElementsByTagName("button")[0]
            
            search.classList += "col "
            // search.style.AlignContent = "center"
            // search.classList += "col"

            // button.classList += "col-1"
            
            category_filter.classList += "col-1 "
            // console.log(category_filter);
            // category_filter.getElementsByTagName("label")[0].innerHTML = ""
            // category_filter.getElementsByTagName("select")[0].classList += "btn btn-secondary"
            // options = category_filter.getElementsByTagName("select")[0].getElementsByTagName("option")
            category_filter.innerHTML = category_filter.getElementsByTagName("select")[0].outerHTML
            category_filter.getElementsByTagName("select")[0].classList += "btn btn-secondary"
            category_filter.getElementsByTagName("select")[0].style.margin = 0
            
            options = category_filter.getElementsByTagName("option")
            options[0].text = "Category"
            for (let index = 0; index < options.length; index++) {
                options[index].classList += "dropdown-item"
                options[index].style.textAlign = "left"
            }
            
            grid_div.innerHTML = search.outerHTML + category_filter.outerHTML
            //  + button.outerHTML
            search_filter_form.innerHTML = grid_div.outerHTML
            console.log(grid_div);
        };
    // )
    </script>

{% endblock %}